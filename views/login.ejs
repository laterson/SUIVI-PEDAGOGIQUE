<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Connexion ‚Äî Plateforme p√©dagogique</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <style>
    :root{
      --bg:#0b1220; --panel:#0f172a; --card:#0b1220;
      --text:#f1f5f9; --muted:#cbd5e1; --edge:rgba(255,255,255,.12);
      --primary:#6366f1; --primary-2:#4338ca; --ring:#818cf8;
      --ok:#10b981; --warn:#f59e0b; --err:#ef4444; --accent:#22d3ee;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg:#f6f8ff; --panel:#ffffff; --card:#ffffff;
        --text:#0b1220; --muted:#334155; --edge:rgba(2,6,23,.12);
        --primary:#4f46e5; --primary-2:#4338ca; --ring:#4f46e5; --accent:#0891b2;
      }
    }

    html,body{height:100%;margin:0}
    body{font-family:Inter,ui-sans-serif,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--text);background:var(--bg)}
    .shell{min-height:100dvh;display:grid;grid-template-columns:1fr}
    @media (min-width:980px){.shell{grid-template-columns:1.25fr 1fr}}

    /* HERO */
    .hero{
      position:relative;padding:32px;display:flex;flex-direction:column;gap:22px;
      background:
        radial-gradient(900px 480px at 0% 0%, rgba(99,102,241,.25), transparent 45%),
        radial-gradient(700px 460px at 100% 10%, rgba(34,211,238,.22), transparent 40%),
        linear-gradient(180deg, rgba(2,6,23,.85), rgba(2,6,23,.65));
      isolation:isolate;overflow:hidden;
    }
    /* canvas INSIDE .hero */
    .orbs{position:absolute;inset:0;z-index:0;pointer-events:none;opacity:.35;filter:saturate(115%)}
    .panelReadable{
      position:relative;z-index:1;margin:auto 0;max-width:780px;border-radius:20px;padding:28px 26px;
      border:1px solid var(--edge);
      background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.03));
      backdrop-filter:blur(6px) saturate(130%);box-shadow:0 22px 60px rgba(0,0,0,.25);
      animation:in .45s ease-out both;
    }
    @keyframes in{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

    .brand{display:flex;align-items:center;gap:14px;margin-bottom:6px}
    .logo{width:52px;height:52px;border-radius:14px;display:grid;place-items:center;background:radial-gradient(120% 120% at 70% 20%,#60a5fa 0%,#6366f1 55%,#0ea5e9 100%);box-shadow:0 12px 28px rgba(99,102,241,.35),inset 0 0 16px rgba(255,255,255,.22);font-size:24px}
    .title{margin:0;font-size:34px;line-height:1.15;letter-spacing:.2px}
    .lead{margin:8px 0 18px;color:var(--muted);font-size:16px;line-height:1.7;max-width:70ch}

    .features{display:grid;gap:12px;grid-template-columns:1fr;margin-top:4px}
    @media (min-width:720px){.features{grid-template-columns:1fr 1fr 1fr}}
    .feat{border:1px solid var(--edge);border-radius:14px;padding:14px 14px 12px;background:var(--card)}
    .feat h3{margin:0 0 6px;font-size:15px;display:flex;gap:8px;align-items:center}
    .feat p{margin:0;font-size:14px;color:var(--muted)}

    .kpis{margin-top:16px;display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}
    .kpi{border:1px dashed var(--edge);border-radius:12px;padding:10px 12px;text-align:center;background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02))}
    .kpi b{display:block;font-size:22px}
    .kpi small{color:var(--muted)}

    /* LOGIN */
    .panel{display:grid;place-items:center;padding:26px;background:linear-gradient(180deg,var(--panel),color-mix(in oklab,var(--panel) 85%,transparent))}
    .login{width:100%;max-width:440px;border-radius:18px;padding:22px;border:1px solid var(--edge);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));backdrop-filter:blur(6px) saturate(140%);box-shadow:0 20px 60px rgba(0,0,0,.18)}
    .topline{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .tabs{display:flex;gap:8px}
    .tab{flex:1;text-align:center;padding:9px 12px;border-radius:999px;text-decoration:none;border:1px solid var(--edge);color:inherit;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));transition:.18s ease}
    .tab:hover{transform:translateY(-1px)}
    .tab.active{background:linear-gradient(180deg,var(--primary),var(--primary-2));color:#fff;border-color:transparent}

    .theme{display:inline-grid;place-items:center;width:42px;height:42px;border-radius:12px;border:1px solid var(--edge);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));cursor:pointer;user-select:none}

    label{display:block;font-weight:600;margin:10px 0 6px}
    .in{width:100%;border-radius:12px;border:1px solid var(--edge);background:rgba(2,6,23,.06);color:inherit;padding:12px;font-size:16px;outline:none;transition:.18s ease}
    .in:focus{border-color:var(--ring);box-shadow:0 0 0 3px color-mix(in oklab,var(--ring) 30%,transparent)}

    .pwd{position:relative}
    .toggle{position:absolute;right:8px;top:50%;transform:translateY(-50%);border:0;background:transparent;color:var(--muted);cursor:pointer;padding:6px 8px;border-radius:8px}
    .toggle:hover{color:var(--text)}

    .btn{width:100%;margin-top:14px;padding:12px;font-weight:700;border-radius:12px;color:#fff;cursor:pointer;border:0;letter-spacing:.2px;background:linear-gradient(180deg,var(--primary),var(--primary-2));transition:.18s ease}
    .btn:hover{filter:saturate(110%) brightness(1.02);transform:translateY(-1px)}

    .err{margin-bottom:10px;padding:10px;border-radius:10px;border:1px solid color-mix(in oklab,var(--err) 40%,transparent);background:color-mix(in oklab,var(--err) 12%,transparent);color:color-mix(in oklab,var(--err) 80%,#fff)}

    .dev{margin-top:16px;border-radius:14px;padding:12px;border:1px dashed var(--edge);background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02))}
    .dev h3{margin:0 0 6px;font-size:14px;display:flex;align-items:center;gap:8px}
    .dot{width:8px;height:8px;border-radius:50%;background:var(--ok);box-shadow:0 0 14px var(--ok)}
    .devgrid{display:grid;grid-template-columns:1fr;gap:8px}
    @media (min-width:520px){.devgrid{grid-template-columns:1fr 1fr}}
    .devcard{padding:10px 15px;border-radius:12px;border:1px solid var(--edge);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));font-size:14px}

    @media (max-width:600px){.hero{padding:22px}.panel{padding:16px}.login{padding:16px}}
    @media (prefers-reduced-motion:reduce){.orbs{display:none!important}}
  </style>
</head>
<body>
  <div class="shell">

    <!-- ===== HERO (le canvas est DEDANS) ===== -->
    <section class="hero" aria-label="Pr√©sentation">
      <canvas class="orbs" id="orbs" aria-hidden="true"></canvas>

      <div class="panelReadable">
        <div class="brand">
          <div class="logo" aria-hidden="true">üìä</div>
          <h1 class="title">Pilotage p√©dagogique, simple et clair.</h1>
        </div>
        <p class="lead">
          Une plateforme unifi√©e pour <strong>collecter</strong> les √©valuations,
          <strong>analyser</strong> la progression et <strong>suivre</strong> la carte scolaire,
          avec un <strong>chat persistant</strong> par inspection.
        </p>

        <div class="features" role="list">
          <article class="feat" role="listitem" aria-label="Suivi des √©valuations">
            <h3>‚úÖ Suivi des √©valuations</h3>
            <p>Vue par trimestre (T1¬∑T2¬∑T3) et par √©tablissement, avec taux de couverture.</p>
          </article>
          <article class="feat" role="listitem" aria-label="KPI r√©gionaux">
            <h3>üìà KPI r√©gionaux</h3>
            <p>Heures faites, le√ßons, TP digitaux et indicateurs de r√©ussite en temps r√©el.</p>
          </article>
          <article class="feat" role="listitem" aria-label="Carte scolaire & personnel">
            <h3>üè´ Carte scolaire & personnel</h3>
            <p>Effectifs filles/gar√ßons, classes ouvertes et enseignants en poste.</p>
          </article>
        </div>

        <div class="kpis" aria-label="Chiffres cl√©s">
          <div class="kpi"><b>54</b><small>√âtablissements actifs</small></div>
          <div class="kpi"><b>87%</b><small>Le√ßons faites</small></div>
          <div class="kpi"><b>‚àû</b><small>Historique du chat</small></div>
        </div>
      </div>
    </section>

    <!-- ===== LOGIN ===== -->
    <section class="panel" aria-label="Connexion">
      <div class="login">
        <div class="topline">
          <nav class="tabs" aria-label="Choix du r√¥le">
            <a class="tab <%= (role==='admin')?'active':'' %>" href="/login?role=admin">Admin</a>
            <a class="tab <%= (role==='insp')?'active':'' %>" href="/login?role=insp">Inspecteur</a>
            <a class="tab <%= (role==='anim')?'active':'' %>" href="/login?role=anim">Animateur</a>
          </nav>
          <button class="theme" id="themeBtn" type="button">üåì</button>
        </div>

        <% if (error) { %><div class="err" role="alert"><%= error %></div><% } %>

        <form method="post" action="/auth/login" autocomplete="on" novalidate>
          <input type="hidden" name="role" value="<%= role || 'anim' %>" />
          <label for="email">Email</label>
          <input id="email" name="email" type="email" class="in" required autofocus placeholder="prenom.nom@domaine.fr" />
          <label for="password">Mot de passe</label>
          <div class="pwd">
            <input id="password" name="password" type="password" class="in" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
            <button class="toggle" type="button" id="togglePwd" aria-label="Afficher le mot de passe">üëÅÔ∏è</button>
          </div>
          <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:8px">
            <label style="display:flex;align-items:center;gap:8px;font-weight:500">
              <input type="checkbox" name="remember" style="accent-color: var(--primary)" />
              Se souvenir de moi
            </label>
            <small><a href="#" style="color:var(--primary);text-decoration:none" aria-disabled="true">Mot de passe oubli√© ?</a></small>
          </div>
          <button class="btn">Se connecter</button>
        </form>

        <div class="dev" aria-labelledby="dev-title">
          <h3 id="dev-title"><span class="dot" aria-hidden="true"></span> √Ä propos du d√©veloppeur</h3>
          <div class="devgrid">
            <div class="devcard">üë®‚Äçüíª <b>Nom</b> : LATERSON Messi,IPR-TI</div>
            <div class="devcard">‚úâÔ∏è <b>Contact</b> : latersonj@gmail.com</div>
            <div class="devcard">üêô <b>GitHub</b> : github.com/laterson</div>
            <div class="devcard">üß∞ <b>contact</b> : (+237) 696270810 </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <script>
    // Afficher/masquer le mot de passe
    (function(){
      const btn=document.getElementById('togglePwd'); const pwd=document.getElementById('password');
      if(btn&&pwd){ btn.addEventListener('click', ()=>{ const t=pwd.type==='password'?'text':'password'; pwd.type=t; btn.textContent=t==='password'?'üëÅÔ∏è':'üôà'; });}
    })();
    // Th√®me
    (function(){
      const btn=document.getElementById('themeBtn'), key='login.theme';
      const set=m=>{document.body.dataset.theme=m; localStorage.setItem(key,m);};
      const saved=localStorage.getItem(key); if(saved) document.body.dataset.theme=saved;
      btn?.addEventListener('click', ()=>{ const cur=document.body.dataset.theme||'auto'; set(cur==='dark'?'light':cur==='light'?'auto':'dark');});
    })();

    /* ====== Orbes flottants (fix√©) ====== */
    (function(){
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      const canvas=document.getElementById('orbs'); if(!canvas) return;
      const ctx=canvas.getContext('2d',{alpha:true});

      let W=0,H=0,dpr=1, orbs=[], raf=null, paused=false;
      const DARK=['#60a5fa','#22d3ee','#a78bfa','#38bdf8'];
      const LIGHT=['#4f46e5','#0891b2','#6366f1','#0ea5e9'];

      function resize(){
        const box=canvas.parentElement.getBoundingClientRect();
        W=Math.max(600,box.width); H=box.height;
        dpr=Math.min(2, window.devicePixelRatio||1);
        canvas.width=Math.floor(W*dpr); canvas.height=Math.floor(H*dpr);
        canvas.style.width=W+'px'; canvas.style.height=H+'px';
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }
      function rand(a,b){return a+Math.random()*(b-a);}
      function pick(a){return a[(Math.random()*a.length)|0];}
      function hex2rgba(hex,a){const v=hex.slice(1);const r=parseInt(v.slice(0,2),16),g=parseInt(v.slice(2,4),16),b=parseInt(v.slice(4,6),16);return `rgba(${r},${g},${b},${a})`;}
      function reset(o){
        const colors=matchMedia('(prefers-color-scheme: light)').matches?LIGHT:DARK;
        o.x=rand(-W*0.15, W*1.15); o.y=rand(-H*0.15, H*1.15);
        o.r=rand(16,60); o.vx=rand(-0.05,0.05); o.vy=rand(-0.05,0.05);
        o.c=pick(colors); o.a=rand(0.35,0.8);
      }
      function make(n){ orbs=Array.from({length:n},()=>{const o={}; reset(o); return o;}); }

      function tick(){
        if(paused) return;
        ctx.clearRect(0,0,W,H);

        for(const o of orbs){
          o.x+=o.vx*16; o.y+=o.vy*16;
          if(o.x<-W*0.2) o.x=W*1.1; if(o.x>W*1.2) o.x=-W*0.1;
          if(o.y<-H*0.2) o.y=H*1.1; if(o.y>H*1.2) o.y=-H*0.1;

          const g=ctx.createRadialGradient(o.x,o.y,1, o.x,o.y,o.r*1.6);
          g.addColorStop(0, 'rgba(255,255,255,0.35)');
          g.addColorStop(0.3, hex2rgba(o.c, o.a));
          g.addColorStop(1, 'rgba(0,0,0,0)');
          ctx.globalCompositeOperation='lighter';
          ctx.fillStyle=g;
          ctx.beginPath(); ctx.arc(o.x,o.y,o.r,0,Math.PI*2); ctx.fill();
          ctx.globalCompositeOperation='source-over';
        }
        raf=requestAnimationFrame(tick);
      }

      function start(){ if(raf) cancelAnimationFrame(raf); paused=false; raf=requestAnimationFrame(tick); }
      function stop(){ paused=true; if(raf) cancelAnimationFrame(raf); raf=null; }

      resize(); make(Math.max(10, Math.floor(window.innerWidth/140)));
      window.addEventListener('resize', ()=>{ resize(); make(Math.max(10, Math.floor(window.innerWidth/140))); });
      document.addEventListener('visibilitychange', ()=>{ if(document.hidden) stop(); else start(); });
      start();

      // Parallaxe subtile
      document.querySelector('.hero')?.addEventListener('mousemove', (e)=>{
        const r=canvas.getBoundingClientRect(), cx=r.left+r.width/2, cy=r.top+r.height/2;
        const dx=(e.clientX-cx)/r.width, dy=(e.clientY-cy)/r.height;
        const ax=dx*0.05, ay=dy*0.05;
        orbs.forEach(o=>{ o.vx += (ax - o.vx)*0.08; o.vy += (ay - o.vy)*0.08; });
      }, {passive:true});
    })();
  </script>
</body>
</html>
